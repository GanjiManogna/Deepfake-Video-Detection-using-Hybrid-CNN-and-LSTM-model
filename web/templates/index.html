<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Deepfake Detector</title>
    <style>
      :root {
        --bg: #0b0b0f;
        --panel: #0f1115;
        --panel2: #111318;
        --border: #22242b;
        --text: #e5e7eb;
        --muted: #a1a1aa;
        --accent: #7c5cff;
        --accent-2: #6d28d9;
        --good: #16351a;
        --goodText: #b7f5c4;
        --bad: #3a1014;
        --badText: #ffc9c9;
        --progress-bg: #2d2f3a;
      }
      
      body {
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        margin: 0;
        background: var(--bg);
        color: var(--text);
        line-height: 1.6;
      }
      
      .wrap {
        max-width: 1200px;
        margin: 0 auto;
        padding: 40px 24px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        box-sizing: border-box;
      }
      
      h1 {
        margin: 6px 0 16px;
        font-size: 30px;
        text-align: center;
      }
      
      .card {
        width: 100%;
        max-width: 800px;
        padding: 48px 40px;
        border: 1px solid var(--border);
        border-radius: 20px;
        background: linear-gradient(180deg, var(--panel), var(--panel2));
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.25);
        margin: 0 auto;
      }
      
      .upload-area {
        border: 3px dashed var(--border);
        border-radius: 16px;
        padding: 48px 40px;
        text-align: center;
        margin: 0 0 32px 0;
        transition: all 0.3s ease;
      }
      
      .upload-area:hover {
        border-color: var(--accent);
        background: rgba(124, 92, 255, 0.05);
      }
      
      .upload-area.dragover {
        background: rgba(124, 92, 255, 0.1);
        border-color: var(--accent);
      }
      
      input[type=file] {
        display: none;
      }
      
      .file-label {
        display: inline-block;
        padding: 14px 32px;
        background: var(--accent);
        color: white;
        border-radius: 10px;
        cursor: pointer;
        font-weight: 600;
        font-size: 16px;
        transition: all 0.2s ease;
        margin-bottom: 16px;
      }
      
      .file-label:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(124, 92, 255, 0.3);
      }
      
      button {
        padding: 12px 24px;
        background: var(--accent);
        color: #fff;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        font-size: 16px;
        transition: all 0.2s ease;
        width: 100%;
        margin-top: 16px;
      }
      
      button:hover:not(:disabled) {
        filter: brightness(1.1);
        transform: translateY(-1px);
      }
      
      button:disabled {
        opacity: 0.7;
        cursor: not-allowed;
      }
      
      .result-container {
        margin-top: 24px;
        display: none;
      }
      
      .result-card {
        background: var(--panel2);
        border-radius: 12px;
        padding: 24px;
        border: 1px solid var(--border);
        margin-top: 20px;
      }
      
      .result-header {
        display: flex;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 16px;
        border-bottom: 1px solid var(--border);
      }
      
      .result-icon {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 16px;
        font-size: 24px;
      }
      
      .result-title {
        font-size: 24px;
        font-weight: 700;
        margin: 0;
      }
      
      .confidence-meter {
        margin: 24px 0;
      }
      
      .confidence-label {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
        font-size: 14px;
        color: var(--muted);
      }
      
      .progress-container {
        height: 10px;
        background: var(--progress-bg);
        border-radius: 5px;
        overflow: hidden;
        margin-bottom: 24px;
      }
      
      .progress-bar {
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, var(--accent), var(--accent-2));
        border-radius: 5px;
        transition: width 0.3s ease;
      }
      
      .analysis-details {
        margin-top: 24px;
      }
      
      .detail-item {
        display: flex;
        justify-content: space-between;
        padding: 12px 0;
        border-bottom: 1px solid var(--border);
      }
      
      .detail-item:last-child {
        border-bottom: none;
      }
      
      .detail-label {
        color: var(--muted);
      }
      
      .detail-value {
        font-weight: 600;
      }
      
      .loading {
        text-align: center;
        margin: 20px 0;
        display: none;
      }
      
      .spinner {
        width: 40px;
        height: 40px;
        margin: 0 auto 16px;
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-left-color: var(--accent);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      
      .file-info {
        margin-top: 12px;
        font-size: 14px;
        color: var(--muted);
      }
      
      .btn-secondary {
        padding: 12px 20px;
        background: var(--panel2);
        border: 1px solid var(--border);
        border-radius: 8px;
        color: var(--text);
        text-decoration: none;
        display: inline-block;
        transition: all 0.2s ease;
        text-align: center;
        margin-top: 16px;
      }
      
      .btn-secondary:hover {
        background: var(--panel);
        border-color: var(--accent);
      }
      /* Single-row model buttons on wide screens */
      #model-buttons .row { display:flex; gap:15px; justify-content:center; align-items:center; flex-wrap:nowrap }
      @media (max-width: 700px){ #model-buttons .row { flex-wrap:wrap } }
      
      .real { color: var(--goodText); }
      .fake { color: var(--badText); }
      
      .real-bg { background-color: var(--good); }
      .fake-bg { background-color: var(--bad); }
      
      .hidden { display: none; }
    </style>
  </head>
  <body>
    <div class="wrap">
      <h1>Deepfake Detector</h1>
      <div class="card">
        <div id="upload-section">
          <div class="upload-area" id="drop-area">
            <label for="video" class="file-label">Choose Video File</label>
            <p>or drag and drop a video file here</p>
            <div class="file-info" id="file-info">No file selected</div>
          </div>
          <input type="file" id="video" name="video" accept="video/*" required />
          <div style="margin-top:12px; display:flex; gap:12px; align-items:center; justify-content:center; flex-wrap:wrap;">
            <span class="detail-label">Ground Truth (Required for metrics):</span>
            <label><input type="radio" name="gt" value="REAL" id="gt-real"> Real</label>
            <label><input type="radio" name="gt" value="FAKE" id="gt-fake"> Fake</label>
            <label><input type="radio" name="gt" value="UNKNOWN" id="gt-unknown" checked> Unknown</label>
          </div>
          <div style="margin-top:8px; text-align:center; color:var(--muted); font-size:14px;">
            ‚ö†Ô∏è Select "Real" or "Fake" to see per-video accuracy metrics
          </div>
        </div>
        
        <!-- Model Selection Buttons -->
        <div id="model-buttons" style="display: none; margin-top: 20px;">
          <h3 style="text-align: center; margin-bottom: 20px; color: var(--text);">Select Model to Analyze</h3>
          
          <!-- HYBRID button on top -->
          <div style="text-align: center; margin-bottom: 20px;">
            <button id="hybrid-btn" class="model-btn" style="background: linear-gradient(45deg, #667eea, #764ba2); padding: 18px 35px; border-radius: 12px; color: white; border: none; cursor: pointer; font-weight: 700; font-size: 18px; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);">
              ü§ñ Hybrid CNN+LSTM
            </button>
          </div>
          
          <!-- CNN and LSTM buttons in same line below -->
          <div class="row" style="display: flex; justify-content: center; gap: 20px; align-items: center; flex-wrap: nowrap;">
            <button id="cnn-btn" class="model-btn" style="background: linear-gradient(45deg, #ff6b6b, #ee5a24); padding: 15px 25px; border-radius: 10px; color: white; border: none; cursor: pointer; font-weight: 600; font-size: 16px; min-width: 150px;">
              üñºÔ∏è CNN-Only
            </button>
            <button id="lstm-btn" class="model-btn" style="background: linear-gradient(45deg, #4ecdc4, #44a08d); padding: 15px 25px; border-radius: 10px; color: white; border: none; cursor: pointer; font-weight: 600; font-size: 16px; min-width: 150px;">
              üîÑ LSTM-Only
            </button>
          </div>
        </div>
        
        <!-- Loading State -->
        <div class="loading" id="loading">
          <div class="spinner"></div>
          <p>Analyzing video. This may take a moment...</p>
          <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
          </div>
          <div id="progress-text">0%</div>
        </div>
        
        <!-- Results Container -->
        <div class="result-container" id="result-container" style="display: none;">
          <!-- Individual Model Result -->
          <div class="result-card" id="model-result">
            <div class="result-header">
              <div class="result-icon" id="model-icon">üéØ</div>
              <h2 class="result-title" id="model-title">Model Analysis</h2>
            </div>
            
            <div class="confidence-meter">
              <div class="confidence-label">
                <span>Confidence</span>
                <span id="model-confidence">0%</span>
              </div>
              <div class="progress-container">
                <div class="progress-bar" id="model-confidence-bar"></div>
              </div>
            </div>
            
            <div class="analysis-details" id="model-details">
              <!-- Will be populated by JavaScript -->
            </div>
            </div>
            
          <button id="new-analysis" style="margin-top: 24px; padding: 12px 20px; background: linear-gradient(135deg, var(--accent), var(--accent-2)); border: none; border-radius: 8px; color: white; text-decoration: none; width: 100%; font-weight: 600; cursor: pointer; box-shadow: 0 4px 12px rgba(124, 92, 255, 0.3); transition: all 0.2s ease;">
              Analyze Another Video
            </button>
        </div>
        
        <a id="view-metrics-link" href="/metrics" style="display: none; text-align: center; margin-top: 24px; padding: 12px 20px; background: var(--panel2); border: none; border-radius: 8px; color: var(--text); text-decoration: none; width: 100%; font-weight: 600; cursor: pointer; transition: all 0.2s ease;">
          View Accuracy Metrics
        </a>
      </div>
      
      <p style="margin-top:24px; text-align: center;">
        <a href="/">‚Üê Back to Home</a>
      </p>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const fileInput = document.getElementById('video');
        const fileInfo = document.getElementById('file-info');
        const loadingElement = document.getElementById('loading');
        const resultContainer = document.getElementById('result-container');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const modelButtons = document.getElementById('model-buttons');
        const newAnalysisBtn = document.getElementById('new-analysis');
        const viewMetricsLink = document.getElementById('view-metrics-link');
        const dropArea = document.getElementById('drop-area');
        
        // Model buttons
        const cnnBtn = document.getElementById('cnn-btn');
        const lstmBtn = document.getElementById('lstm-btn');
        const hybridBtn = document.getElementById('hybrid-btn');
        
        // Result elements
        const modelIconEl = document.getElementById('model-icon');
        const modelTitle = document.getElementById('model-title');
        const modelConfidence = document.getElementById('model-confidence');
        const modelConfidenceBar = document.getElementById('model-confidence-bar');
        const modelDetails = document.getElementById('model-details');
        
        let currentVideo = null;
        let currentResults = null; // cache server response to avoid re-upload
        let lastSelectedModel = null; // track last selected model
        
        // Restore previous results from sessionStorage when page loads
        window.addEventListener('DOMContentLoaded', function() {
          try {
            const savedResults = sessionStorage.getItem('deepfake_results');
            const savedModel = sessionStorage.getItem('last_selected_model');
            if (savedResults) {
              currentResults = JSON.parse(savedResults);
              lastSelectedModel = savedModel;
              
              // Show model buttons if we have results
              if (currentResults) {
                modelButtons.style.display = 'block';
                resultContainer.style.display = 'block';  // Make sure result container is visible
                loadingElement.style.display = 'none';     // Hide loading if visible
                
                // Restore ground truth selection if saved
                const savedGT = sessionStorage.getItem('last_ground_truth');
                if (savedGT && savedGT !== 'UNKNOWN') {
                  const gtRadio = document.getElementById(`gt-${savedGT.toLowerCase()}`);
                  if (gtRadio) {
                    gtRadio.checked = true;
                  }
                }
                
                // Show the last selected model result, or default to hybrid
                const modelToShow = savedModel || 'hybrid';
                showModelResult(modelToShow, currentResults);
                if (viewMetricsLink) viewMetricsLink.style.display = 'block';
                // Update file info if possible
                if (currentResults.filename) {
                  fileInfo.textContent = `Last analyzed: ${currentResults.filename}`;
                  fileInfo.style.color = 'var(--text)';
                }
              }
            }
          } catch (e) {
            console.error('Error restoring results:', e);
          }
        });
        let isFetching = false;
        
        // Prevent default drag behaviors
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
          dropArea.addEventListener(eventName, preventDefaults, false);
          document.body.addEventListener(eventName, preventDefaults, false);
        });
        
        // Highlight drop area when item is dragged over it
        ['dragenter', 'dragover'].forEach(eventName => {
          dropArea.addEventListener(eventName, highlight, false);
        });
        
        ['dragleave', 'drop'].forEach(eventName => {
          dropArea.addEventListener(eventName, unhighlight, false);
        });
        
        // Handle dropped files
        dropArea.addEventListener('drop', handleDrop, false);
        
        function preventDefaults(e) {
          e.preventDefault();
          e.stopPropagation();
        }
        
        function highlight() {
          dropArea.classList.add('dragover');
        }
        
        function unhighlight() {
          dropArea.classList.remove('dragover');
        }
        
        function handleDrop(e) {
          const dt = e.dataTransfer;
          const files = dt.files;
          
          if (files.length) {
            fileInput.files = files;
            updateFileInfo(files[0]);
          }
        }
        
        // Handle file selection via button
        fileInput.addEventListener('change', function() {
          if (this.files && this.files[0]) {
            currentVideo = this.files[0];
            updateFileInfo(this.files[0]);
            modelButtons.style.display = 'block';
            resultContainer.style.display = 'none';
          }
        });
        
        function updateFileInfo(file) {
          const fileSize = (file.size / (1024 * 1024)).toFixed(2); // Convert to MB
          fileInfo.textContent = `Selected: ${file.name} (${fileSize} MB)`;
          fileInfo.style.color = 'var(--text)';
        }
        
        // Model button click handlers
        cnnBtn.addEventListener('click', () => analyzeWithModel('cnn'));
        lstmBtn.addEventListener('click', () => analyzeWithModel('lstm'));
        hybridBtn.addEventListener('click', () => analyzeWithModel('hybrid'));
        
        // New analysis button - reset everything to start fresh
        newAnalysisBtn.addEventListener('click', function() {
          // Hide results and model buttons
          resultContainer.style.display = 'none';
          modelButtons.style.display = 'none';
          viewMetricsLink.style.display = 'none';
          loadingElement.style.display = 'none';
          
          // Reset form elements
          fileInput.value = '';
          fileInfo.textContent = 'No file selected';
          fileInfo.style.color = 'var(--muted)';
          
          // Reset ground truth selection to Unknown
          const gtUnknownRadio = document.getElementById('gt-unknown');
          if (gtUnknownRadio) {
            gtUnknownRadio.checked = true;
          }
          
          // Clear state variables
          currentVideo = null;
          currentResults = null;
          lastSelectedModel = null;
          
          // Clear sessionStorage
          try {
            sessionStorage.removeItem('deepfake_results');
            sessionStorage.removeItem('last_selected_model');
            sessionStorage.removeItem('last_ground_truth');
          } catch (e) {
            console.error('Error clearing storage:', e);
          }
          
          // Show upload area again
          const uploadSection = document.getElementById('upload-section');
          if (uploadSection) {
            uploadSection.style.display = 'block';
          }
        });
        
        async function analyzeWithModel(modelType) {
          if (!currentVideo) {
            fileInfo.textContent = 'Please select a video file first';
            fileInfo.style.color = 'var(--badText)';
            return;
          }
          
          // If we already have results cached for this video, just show them instantly
          if (currentResults) {
            try { showModelResult(modelType, currentResults); } catch (_) {}
            return;
          }
          
          // Show loading state
          if (!isFetching) {
          loadingElement.style.display = 'block';
          resultContainer.style.display = 'none';
          }
          
          // Disable all model buttons
          [cnnBtn, lstmBtn, hybridBtn].forEach(btn => btn.disabled = true);
          
          // Simulate progress
          simulateProgress();
          
          if (isFetching) return; // prevent parallel uploads
          isFetching = true;
          
          const data = new FormData();
          data.append('video', currentVideo);
          const gtVal = (document.querySelector('input[name="gt"]:checked')?.value || 'UNKNOWN').toUpperCase();
          data.append('gt', gtVal);
          console.log('DEBUG: Sending Ground Truth:', gtVal);
          
          // Save ground truth selection to sessionStorage
          try {
            sessionStorage.setItem('last_ground_truth', gtVal);
          } catch (e) {
            console.error('Error saving ground truth:', e);
          }
          
          try {
            const response = await fetch('/detect', { 
              method: 'POST', 
              body: data 
            });
            
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            const result = await response.json();
            currentResults = result;
            lastSelectedModel = modelType;
            
            // Save to sessionStorage for persistence
            try {
              sessionStorage.setItem('deepfake_results', JSON.stringify(result));
              sessionStorage.setItem('last_selected_model', modelType);
            } catch (e) {
              console.error('Error saving results:', e);
            }
            
            showModelResult(modelType, result);
            if (viewMetricsLink) viewMetricsLink.style.display = 'block';
            
          } catch (error) {
            console.error('Error:', error);
            showError(error.message || 'An error occurred during analysis');
          } finally {
            loadingElement.style.display = 'none';
            [cnnBtn, lstmBtn, hybridBtn].forEach(btn => btn.disabled = false);
            isFetching = false;
          }
        }
        
        function simulateProgress() {
          let progress = 0;
          const interval = setInterval(() => {
            progress += Math.random() * 10;
            if (progress >= 90) {
              clearInterval(interval);
              return;
            }
            updateProgress(progress);
          }, 300);
        }
        
        function updateProgress(percent) {
          progressBar.style.width = `${percent}%`;
          progressText.textContent = `${Math.round(percent)}%`;
        }
        
        function showModelResult(modelType, data) {
          let modelData = null;
          let modelName = '';
          let modelGlyph = '';
          let modelColor = '';
          
          // Get the specific model data
          if (modelType === 'cnn' && data.cnn_only) {
            modelData = data.cnn_only;
            modelName = 'CNN-Only Model';
            modelGlyph = 'üñºÔ∏è';
            modelColor = 'linear-gradient(45deg, #ff6b6b, #ee5a24)';
          } else if (modelType === 'lstm' && data.lstm_only) {
            modelData = data.lstm_only;
            modelName = 'LSTM-Only Model';
            modelGlyph = 'üîÑ';
            modelColor = 'linear-gradient(45deg, #4ecdc4, #44a08d)';
          } else if (modelType === 'hybrid' && data.hybrid) {
            modelData = data.hybrid;
            modelName = 'Hybrid CNN+LSTM';
            modelGlyph = 'ü§ñ';
            modelColor = 'linear-gradient(45deg, #667eea, #764ba2)';
          }
          
          if (!modelData) {
            showError(`${modelName} prediction not available`);
            return;
          }
          
          const isFake = modelData.prediction === 'FAKE';
          const confidence = (modelData.confidence * 100).toFixed(1);
          const gt = (document.querySelector('input[name="gt"]:checked')?.value || 'UNKNOWN').toUpperCase();
          const gtKnown = gt && gt !== 'UNKNOWN';
          const correct = gtKnown ? (modelData.prediction === gt) : null;

          // Per-video metrics
          let metricsHtml = '';
          if (gtKnown) {
            const yTrue = gt === 'FAKE' ? 1 : 0;
            const yPred = modelData.prediction === 'FAKE' ? 1 : 0;
            const TP = (yTrue === 1 && yPred === 1) ? 1 : 0;
            const TN = (yTrue === 0 && yPred === 0) ? 1 : 0;
            const FP = (yTrue === 0 && yPred === 1) ? 1 : 0;
            const FN = (yTrue === 1 && yPred === 0) ? 1 : 0;
            const prec = (TP + FP) > 0 ? (TP / (TP + FP)) : null;
            const rec = (TP + FN) > 0 ? (TP / (TP + FN)) : null;
            const f1 = (prec !== null && rec !== null && (prec + rec) > 0) ? (2 * prec * rec / (prec + rec)) : null;
            metricsHtml = `
              <div class="detail-item">
                <span class="detail-label">Per‚Äëvideo Accuracy</span>
                <span class="detail-value">${correct ? '1.00 (Correct)' : '0.00 (Incorrect)'}${correct ? ' ‚úÖ' : ' ‚ùå'}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">TP / FP / TN / FN</span>
                <span class="detail-value">${TP} / ${FP} / ${TN} / ${FN}</span>
              </div>
              <div class="detail-item">
                <span class="detail-label">Precision / Recall / F1</span>
                <span class="detail-value">${prec !== null ? prec.toFixed(2) : '‚Äî'} / ${rec !== null ? rec.toFixed(2) : '‚Äî'} / ${f1 !== null ? f1.toFixed(2) : '‚Äî'}</span>
              </div>
            `;
          }
          
          // Update UI
          modelTitle.textContent = isFake ? 'Potential Deepfake Detected' : 'Genuine Video';
          modelTitle.className = `result-title ${isFake ? 'fake' : 'real'}`;
          if (modelIconEl) {
            modelIconEl.textContent = isFake ? '‚ö†Ô∏è' : '‚úÖ';
            modelIconEl.className = `result-icon ${isFake ? 'fake-bg' : 'real-bg'}`;
            modelIconEl.style.background = modelColor;
          }
          
          // Update confidence
          modelConfidenceBar.style.width = `${confidence}%`;
          modelConfidence.textContent = `${confidence}%`;
          
          // Extra info for hybrid: speed advantage vs others
          let extraRows = '';
          if (modelType === 'hybrid' && data.processing_times) {
            try {
              const tHybrid = data.processing_times.hybrid || modelData.processing_time || 0;
              const tCnn = data.processing_times.cnn_only || 0.0001;
              const tLstm = data.processing_times.lstm_only || 0.0001;
              const fasterVsCnn = tCnn && tHybrid ? (tCnn / tHybrid).toFixed(1) : '‚Äî';
              const fasterVsLstm = tLstm && tHybrid ? (tLstm / tHybrid).toFixed(1) : '‚Äî';
              extraRows = `
                <div class="detail-item">
                  <span class="detail-label">Speed Advantage</span>
                  <span class="detail-value">${fasterVsCnn}√ó vs CNN, ${fasterVsLstm}√ó vs LSTM</span>
                </div>`;
            } catch (_) {}
          }

          // Update details
          let details = `
            <div class="detail-item">
              <span class="detail-label">Model</span>
              <span class="detail-value">${modelName}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Prediction</span>
              <span class="detail-value ${isFake ? 'fake' : 'real'}">${modelData.prediction}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Confidence</span>
              <span class="detail-value">${confidence}%</span>
            </div>
            ${metricsHtml}
            <div class="detail-item">
              <span class="detail-label">Processing Time</span>
              <span class="detail-value">${modelData.processing_time ? modelData.processing_time.toFixed(2) + 's' : 'N/A'}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Frames Used</span>
              <span class="detail-value">${modelData.frames_used || 'N/A'}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">File Name</span>
              <span class="detail-value">${currentVideo.name}</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">File Size</span>
              <span class="detail-value">${(currentVideo.size / (1024 * 1024)).toFixed(2)} MB</span>
            </div>
            ${extraRows}
          `;
          
          modelDetails.innerHTML = details;
          resultContainer.style.display = 'block';
        }
        
        function showError(message) {
          modelTitle.textContent = 'Analysis Error';
          modelTitle.className = 'result-title fake';
          if (modelIconEl) {
            modelIconEl.textContent = '‚ùå';
            modelIconEl.className = 'result-icon fake-bg';
          }
          modelConfidence.textContent = '0%';
          modelConfidenceBar.style.width = '0%';
          modelDetails.innerHTML = `
            <div class="detail-item">
              <span class="detail-label">Error</span>
              <span class="detail-value fake">${message}</span>
            </div>
          `;
          resultContainer.style.display = 'block';
        }
      });
    </script>
  </body>
  </html>


